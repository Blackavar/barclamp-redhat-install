# Kickstart file automatically generated by anaconda.

install
url=http://<%= @admin_node_ip %>:<%= @install_web_port %>/redhat_dvd
key --skip
lang en_US.UTF-8
keyboard us
xconfig --startxonboot
network --device bootif --bootproto dhcp
# crowbar
rootpw --iscrypted $1$H6F/NLec$Fps2Ut0zY4MjJtsa1O2yk0
firewall --disabled
authconfig --enableshadow --enablemd5
selinux --disabled
timezone --utc Europe/London
bootloader --location=mbr --driveorder=sda --append="rhgb quiet"
zerombr yes
clearpart --all --drives=sda
part /boot --fstype ext3 --size=100 --ondisk=sda
part pv.6 --size=0 --grow --ondisk=sda
volgroup lv_admin --pesize=32768 pv.6
logvol / --fstype ext3 --name=lv_root --vgname=lv_admin --size=1 --grow
reboot

%packages
@base
@core
@editors
@text-internet
keyutils
trousers
fipscheck
device-mapper-multipath
OpenIPMI
OpenIPMI-tools
emacs-nox
openssh

%post --nochroot

mkdir -p /mnt/sysimage/tftpboot/redhat_dvd/dell
cp -a /mnt/source/. /mnt/sysimage/redhat_dvd/.

%post

BASEDIR="/tftpboot/redhat_dvd"

(cd /etc/yum.repos.d && rm *)

cat >/etc/yum.repos.d/RHEL5.6-Base.repo <<EOF
[RHEL56-Base]
name=RHEL 5.6 Server
baseurl=http://<%= @admin_node_ip %>:<%= @install_web_port %>/redhat_dvd/Server
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
EOF

cat >/etc/yum.repos.d/crowbar-xtras.repo <<EOF
[crowbar-xtras]
name=Crowbar Extra Packages
baseurl=http://<%= @admin_node_ip %>:<%= @install_web_port %>/redhat_dvd/extra/pkgs
gpgcheck=0
EOF

